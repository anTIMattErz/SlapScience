
# import packages
import os
import pandas as pd
import datetime


os.chdir("../Data")

catalogue_name = "sc_hot_and_top.csv"
artist_repository = "artist_repository.csv"
song_repository = "song_repository.csv"


pd.set_option('display.max_columns', None)

current_catalogue = pd.read_csv(catalogue_name, index_col = 0)

genre_per_run = pd.DataFrame(current_catalogue\
.groupby(['runID'])\
.genre\
.nunique())

countries_per_run = pd.DataFrame(current_catalogue\
.groupby(['runID'])\
.country\
.nunique())

artists_per_run = pd.DataFrame(current_catalogue\
.groupby(['runID'])\
.artist_name\
.nunique())

songs_per_run = pd.DataFrame(current_catalogue\
.groupby(['runID'])\
.song_name\
.nunique())

from bokeh.plotting import *
from bokeh.layouts import row

p = figure(plot_width=600, 
           plot_height=500, 
           title = "Genres and Country Charts scraped per run",
           x_axis_label = "Run Number")

p.step(genre_per_run.index.values,
       genre_per_run['genre'].values, 
       legend = 'Genre',
       color = 'green',
       line_width=2)

p.step(countries_per_run.index.values,
       countries_per_run['country'].values, 
       legend = 'Country',
       line_width=2)

p.legend.location = "bottom_left"

s = figure(plot_width=600, 
           plot_height=500,
           title = "Songs and Artists scraped per run",
           x_axis_label = "Run Number")

s.line(artists_per_run.index.values,
       artists_per_run['artist_name'].values, 
       legend = 'Artists',
       line_width=2)

s.line(songs_per_run.index.values,
       songs_per_run['song_name'].values, 
       legend = 'Songs',
       color = 'green',
       line_width=2)


s.legend.location = "bottom_left"

qc = gridplot([[p,s]])


show(qc)



